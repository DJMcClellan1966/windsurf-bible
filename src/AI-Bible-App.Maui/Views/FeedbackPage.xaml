<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AI_Bible_App.Maui.Views.FeedbackPage"
             Title="Send Feedback"
             BackgroundColor="{AppThemeBinding Light={StaticResource LightPageBackground}, Dark={StaticResource DarkPageBackground}}">

    <ContentPage.Resources>
        <Style x:Key="SectionLabel" TargetType="Label">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontAttributes" Value="Bold"/>
            <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"/>
            <Setter Property="Margin" Value="0,15,0,5"/>
        </Style>
        
        <Style x:Key="StarButton" TargetType="Button">
            <Setter Property="BackgroundColor" Value="Transparent"/>
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="WidthRequest" Value="44"/>
            <Setter Property="HeightRequest" Value="44"/>
            <Setter Property="Padding" Value="0"/>
        </Style>
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="10">
            
            <!-- Header -->
            <Label Text="We'd Love Your Feedback!"
                   FontSize="24"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"/>
            
            <Label Text="Help us improve the AI Bible App by sharing your thoughts."
                   FontSize="14"
                   HorizontalOptions="Center"
                   Opacity="0.7"
                   Margin="0,0,0,20"/>

            <!-- Feedback Type -->
            <Label Text="What type of feedback?" Style="{StaticResource SectionLabel}"/>
            <Picker x:Name="FeedbackTypePicker"
                    Title="Select type"
                    SelectedIndexChanged="OnTypeChanged">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>üêõ Bug Report</x:String>
                        <x:String>üí° Feature Request</x:String>
                        <x:String>üôè Praise/Thank You</x:String>
                        <x:String>‚ùì Question</x:String>
                        <x:String>üìù General Feedback</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <!-- Category -->
            <Label Text="Which area?" Style="{StaticResource SectionLabel}"/>
            <Picker x:Name="CategoryPicker"
                    Title="Select category">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>Biblical Characters</x:String>
                        <x:String>Prayer Generation</x:String>
                        <x:String>Bible Reading</x:String>
                        <x:String>User Interface</x:String>
                        <x:String>Performance</x:String>
                        <x:String>AI Responses</x:String>
                        <x:String>Other</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <!-- Rating -->
            <Label Text="How would you rate your experience?" Style="{StaticResource SectionLabel}"/>
            <HorizontalStackLayout x:Name="RatingStack" 
                                   HorizontalOptions="Center" 
                                   Spacing="5">
                <Button x:Name="Star1" Text="‚òÜ" Style="{StaticResource StarButton}" Clicked="OnStarClicked"/>
                <Button x:Name="Star2" Text="‚òÜ" Style="{StaticResource StarButton}" Clicked="OnStarClicked"/>
                <Button x:Name="Star3" Text="‚òÜ" Style="{StaticResource StarButton}" Clicked="OnStarClicked"/>
                <Button x:Name="Star4" Text="‚òÜ" Style="{StaticResource StarButton}" Clicked="OnStarClicked"/>
                <Button x:Name="Star5" Text="‚òÜ" Style="{StaticResource StarButton}" Clicked="OnStarClicked"/>
            </HorizontalStackLayout>
            <Label x:Name="RatingLabel" 
                   Text="Tap to rate" 
                   HorizontalOptions="Center"
                   FontSize="12"
                   Opacity="0.6"/>

            <!-- Message -->
            <Label Text="Your feedback" Style="{StaticResource SectionLabel}"/>
            <Editor x:Name="MessageEditor"
                    Placeholder="Tell us what's on your mind..."
                    HeightRequest="150"
                    AutoSize="TextChanges"
                    MaxLength="2000"/>
            <Label x:Name="CharCountLabel" 
                   Text="0/2000"
                   HorizontalOptions="End"
                   FontSize="11"
                   Opacity="0.5"/>

            <!-- Optional Context -->
            <Label Text="What were you doing? (optional)" Style="{StaticResource SectionLabel}"/>
            <Entry x:Name="ContextEntry"
                   Placeholder="e.g., Talking with Paul about faith"
                   MaxLength="200"/>

            <!-- Optional Email -->
            <Label Text="Email (optional, if you'd like a response)" Style="{StaticResource SectionLabel}"/>
            <Entry x:Name="EmailEntry"
                   Placeholder="your.email@example.com"
                   Keyboard="Email"
                   MaxLength="100"/>
            <Label Text="We'll only use this to respond to your feedback"
                   FontSize="11"
                   Opacity="0.5"/>

            <!-- Privacy Note -->
            <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2A2A2A}"
                   Padding="15"
                   CornerRadius="8"
                   Margin="0,15,0,0"
                   BorderColor="Transparent">
                <VerticalStackLayout Spacing="5">
                    <Label Text="üîí Privacy Note"
                           FontAttributes="Bold"
                           FontSize="13"/>
                    <Label Text="Your feedback is stored locally on your device. We don't collect any personal data or send information to external servers."
                           FontSize="12"
                           Opacity="0.8"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Submit Button -->
            <Button x:Name="SubmitButton"
                    Text="Submit Feedback"
                    BackgroundColor="{StaticResource Primary}"
                    TextColor="White"
                    FontAttributes="Bold"
                    HeightRequest="50"
                    CornerRadius="25"
                    Margin="0,20,0,0"
                    Clicked="OnSubmitClicked"/>

            <!-- Cancel -->
            <Button Text="Cancel"
                    BackgroundColor="Transparent"
                    TextColor="{AppThemeBinding Light=Gray, Dark=LightGray}"
                    Margin="0,10,0,20"
                    Clicked="OnCancelClicked"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
