<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:AI_Bible_App.Maui.ViewModels"
             xmlns:models="clr-namespace:AI_Bible_App.Core.Models;assembly=AI-Bible-App.Core"
             x:Class="AI_Bible_App.Maui.Views.NotionHomePage"
             x:DataType="vm:HomeViewModel"
             x:Name="ThisPage"
             Title="Home"
             Shell.NavBarIsVisible="False">
    
    <!-- Notion-inspired clean dark theme -->
    <ContentPage.Background>
        <SolidColorBrush Color="{StaticResource HallowBackground}"/>
    </ContentPage.Background>
    
    <ScrollView>
        <VerticalStackLayout Padding="20,20" Spacing="24">
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- HEADER - User greeting and quick actions                            -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid ColumnDefinitions="*,Auto" Margin="0,10,0,10">
                <VerticalStackLayout Grid.Column="0" Spacing="4">
                    <Label Text="{Binding Greeting}"
                           TextColor="{StaticResource HallowTextMuted}"
                           FontSize="14"/>
                    <Label Text="{Binding UserName}"
                           TextColor="{StaticResource HallowTextPrimary}"
                           FontSize="28"
                           FontAttributes="Bold"/>
                </VerticalStackLayout>
                
                <!-- User Avatar -->
                <Border Grid.Column="1" 
                        WidthRequest="48" HeightRequest="48"
                        StrokeThickness="2"
                        Stroke="{StaticResource HallowAccentPurple}">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="24"/>
                    </Border.StrokeShape>
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Color="{StaticResource HallowAccentPurple}" Offset="0.0" />
                            <GradientStop Color="{StaticResource HallowRose}" Offset="1.0" />
                        </LinearGradientBrush>
                    </Border.Background>
                    <Label Text="{Binding UserEmoji}"
                           FontSize="24"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"/>
                </Border>
            </Grid>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- QUICK ACTIONS - Notion-style action blocks                          -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid ColumnDefinitions="*,*,*" ColumnSpacing="12">
                <!-- New Chat -->
                <Border Grid.Column="0" Padding="16" HeightRequest="100"
                        BackgroundColor="{StaticResource HallowCardBackground}"
                        StrokeThickness="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="16"/>
                    </Border.StrokeShape>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding NewChatCommand}"/>
                    </Border.GestureRecognizers>
                    <VerticalStackLayout Spacing="8" VerticalOptions="Center">
                        <Label Text="ðŸ’¬" FontSize="28" HorizontalOptions="Center"/>
                        <Label Text="New Chat"
                               TextColor="{StaticResource HallowTextPrimary}"
                               FontSize="13"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Border>
                
                <!-- Prayer -->
                <Border Grid.Column="1" Padding="16" HeightRequest="100"
                        BackgroundColor="{StaticResource HallowCardBackground}"
                        StrokeThickness="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="16"/>
                    </Border.StrokeShape>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding PrayerCommand}"/>
                    </Border.GestureRecognizers>
                    <VerticalStackLayout Spacing="8" VerticalOptions="Center">
                        <Label Text="ðŸ™" FontSize="28" HorizontalOptions="Center"/>
                        <Label Text="Prayer"
                               TextColor="{StaticResource HallowTextPrimary}"
                               FontSize="13"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Border>
                
                <!-- Bible -->
                <Border Grid.Column="2" Padding="16" HeightRequest="100"
                        BackgroundColor="{StaticResource HallowCardBackground}"
                        StrokeThickness="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="16"/>
                    </Border.StrokeShape>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding BibleCommand}"/>
                    </Border.GestureRecognizers>
                    <VerticalStackLayout Spacing="8" VerticalOptions="Center">
                        <Label Text="ðŸ“–" FontSize="28" HorizontalOptions="Center"/>
                        <Label Text="Bible"
                               TextColor="{StaticResource HallowTextPrimary}"
                               FontSize="13"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Border>
            </Grid>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- CHARACTERS SECTION - Notion-style database view                     -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <VerticalStackLayout Spacing="12">
                <!-- Section Header -->
                <Grid ColumnDefinitions="*,Auto">
                    <HorizontalStackLayout Grid.Column="0" Spacing="8">
                        <Label Text="ðŸ“š" FontSize="18"/>
                        <Label Text="Characters"
                               TextColor="{StaticResource HallowTextPrimary}"
                               FontSize="18"
                               FontAttributes="Bold"/>
                    </HorizontalStackLayout>
                    <Label Grid.Column="1"
                           Text="View All â†’"
                           TextColor="{StaticResource HallowAccentPurple}"
                           FontSize="14">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ViewAllCharactersCommand}"/>
                        </Label.GestureRecognizers>
                    </Label>
                </Grid>
                
                <!-- Characters Grid (Notion-style cards) -->
                <CollectionView ItemsSource="{Binding FeaturedCharacters}"
                               HeightRequest="180">
                    <CollectionView.ItemsLayout>
                        <LinearItemsLayout Orientation="Horizontal" ItemSpacing="12"/>
                    </CollectionView.ItemsLayout>
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="models:BiblicalCharacter">
                            <Border WidthRequest="140" Padding="16"
                                    BackgroundColor="{StaticResource HallowCardBackground}"
                                    StrokeThickness="0">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="16"/>
                                </Border.StrokeShape>
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer 
                                        Command="{Binding Path=BindingContext.SelectCharacterCommand, Source={x:Reference ThisPage}}"
                                        CommandParameter="{Binding}"/>
                                </Border.GestureRecognizers>
                                <VerticalStackLayout Spacing="10" VerticalOptions="Center">
                                    <!-- Avatar -->
                                    <Border WidthRequest="56" HeightRequest="56"
                                            HorizontalOptions="Center"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="28"/>
                                        </Border.StrokeShape>
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                <GradientStop Color="{StaticResource HallowAccentPurple}" Offset="0.0" />
                                                <GradientStop Color="{StaticResource HallowRose}" Offset="1.0" />
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Label Text="{Binding Emoji}"
                                               FontSize="28"
                                               HorizontalOptions="Center"
                                               VerticalOptions="Center"/>
                                    </Border>
                                    <!-- Name -->
                                    <Label Text="{Binding Name}"
                                           TextColor="{StaticResource HallowTextPrimary}"
                                           FontSize="14"
                                           FontAttributes="Bold"
                                           HorizontalOptions="Center"
                                           HorizontalTextAlignment="Center"/>
                                    <!-- Title -->
                                    <Label Text="{Binding Title}"
                                           TextColor="{StaticResource HallowTextMuted}"
                                           FontSize="11"
                                           HorizontalOptions="Center"
                                           HorizontalTextAlignment="Center"
                                           LineBreakMode="TailTruncation"
                                           MaxLines="1"/>
                                </VerticalStackLayout>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- RECENT CHATS SECTION - Notion-style list                            -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <VerticalStackLayout Spacing="12">
                <!-- Section Header -->
                <Grid ColumnDefinitions="*,Auto">
                    <HorizontalStackLayout Grid.Column="0" Spacing="8">
                        <Label Text="ðŸ’¬" FontSize="18"/>
                        <Label Text="Recent Conversations"
                               TextColor="{StaticResource HallowTextPrimary}"
                               FontSize="18"
                               FontAttributes="Bold"/>
                    </HorizontalStackLayout>
                    <Label Grid.Column="1"
                           Text="View All â†’"
                           TextColor="{StaticResource HallowAccentPurple}"
                           FontSize="14">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ViewAllChatsCommand}"/>
                        </Label.GestureRecognizers>
                    </Label>
                </Grid>
                
                <!-- Recent Chats List -->
                <Border BackgroundColor="{StaticResource HallowCardBackground}"
                        Padding="4"
                        StrokeThickness="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="16"/>
                    </Border.StrokeShape>
                    <CollectionView ItemsSource="{Binding RecentChats}">
                        <CollectionView.EmptyView>
                            <Label Text="No conversations yet"
                                   TextColor="{StaticResource HallowTextMuted}"
                                   FontSize="13"
                                   Padding="12,8"
                                   HorizontalOptions="Center"/>
                        </CollectionView.EmptyView>
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:ChatSession">
                                <Border Padding="14" Margin="4"
                                        BackgroundColor="Transparent"
                                        StrokeThickness="0">
                                    <Border.GestureRecognizers>
                                        <TapGestureRecognizer 
                                            Command="{Binding Path=BindingContext.OpenChatCommand, Source={x:Reference ThisPage}}"
                                            CommandParameter="{Binding}"/>
                                    </Border.GestureRecognizers>
                                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                                        <!-- Character Icon -->
                                        <Border Grid.Column="0" 
                                                WidthRequest="44" HeightRequest="44"
                                                StrokeThickness="0">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="10"/>
                                            </Border.StrokeShape>
                                            <Border.Background>
                                                <SolidColorBrush Color="{StaticResource HallowCardHover}"/>
                                            </Border.Background>
                                            <Label Text="{Binding CharacterEmoji}"
                                                   FontSize="22"
                                                   HorizontalOptions="Center"
                                                   VerticalOptions="Center"/>
                                        </Border>
                                        
                                        <!-- Chat Info -->
                                        <VerticalStackLayout Grid.Column="1" 
                                                            VerticalOptions="Center"
                                                            Spacing="2">
                                            <Label Text="{Binding CharacterName}"
                                                   TextColor="{StaticResource HallowTextPrimary}"
                                                   FontSize="15"
                                                   FontAttributes="Bold"/>
                                            <Label Text="{Binding LastMessagePreview}"
                                                   TextColor="{StaticResource HallowTextMuted}"
                                                   FontSize="13"
                                                   LineBreakMode="TailTruncation"
                                                   MaxLines="1"/>
                                        </VerticalStackLayout>
                                        
                                        <!-- Time -->
                                        <Label Grid.Column="2"
                                               Text="{Binding UpdatedAt, Converter={StaticResource RelativeTimeConverter}}"
                                               TextColor="{StaticResource HallowTextMuted}"
                                               FontSize="12"
                                               VerticalOptions="Center"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </Border>
            </VerticalStackLayout>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- SAVED PRAYERS SECTION - Notion-style blocks                         -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <VerticalStackLayout Spacing="12">
                <!-- Section Header -->
                <Grid ColumnDefinitions="*,Auto">
                    <HorizontalStackLayout Grid.Column="0" Spacing="8">
                        <Label Text="ðŸ™" FontSize="18"/>
                        <Label Text="Saved Prayers"
                               TextColor="{StaticResource HallowTextPrimary}"
                               FontSize="18"
                               FontAttributes="Bold"/>
                    </HorizontalStackLayout>
                    <Label Grid.Column="1"
                           Text="View All â†’"
                           TextColor="{StaticResource HallowAccentPurple}"
                           FontSize="14">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ViewAllPrayersCommand}"/>
                        </Label.GestureRecognizers>
                    </Label>
                </Grid>
                
                <!-- Prayers Grid -->
                <CollectionView ItemsSource="{Binding RecentPrayers}"
                               HeightRequest="160">
                    <CollectionView.ItemsLayout>
                        <LinearItemsLayout Orientation="Horizontal" ItemSpacing="12"/>
                    </CollectionView.ItemsLayout>
                    <CollectionView.EmptyView>
                        <Border WidthRequest="200" Padding="20"
                                BackgroundColor="{StaticResource HallowCardBackground}"
                                StrokeThickness="1"
                                Stroke="{StaticResource HallowDivider}">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="16"/>
                            </Border.StrokeShape>
                            <VerticalStackLayout Spacing="8" VerticalOptions="Center">
                                <Label Text="ðŸ™" FontSize="32" HorizontalOptions="Center"/>
                                <Label Text="No saved prayers yet"
                                       TextColor="{StaticResource HallowTextMuted}"
                                       FontSize="13"
                                       HorizontalOptions="Center"/>
                            </VerticalStackLayout>
                        </Border>
                    </CollectionView.EmptyView>
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="models:Prayer">
                            <Border WidthRequest="200" Padding="16"
                                    BackgroundColor="{StaticResource HallowCardBackground}"
                                    StrokeThickness="0">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="16"/>
                                </Border.StrokeShape>
                                <VerticalStackLayout Spacing="8">
                                    <!-- Prayer Type Badge -->
                                    <Border Padding="8,4"
                                            BackgroundColor="{StaticResource HallowCardHover}"
                                            HorizontalOptions="Start"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Label Text="{Binding PrayerType}"
                                               TextColor="{StaticResource HallowAccentPurple}"
                                               FontSize="11"
                                               FontAttributes="Bold"/>
                                    </Border>
                                    <!-- Preview -->
                                    <Label Text="{Binding Content}"
                                           TextColor="{StaticResource HallowTextSecondary}"
                                           FontSize="13"
                                           LineBreakMode="TailTruncation"
                                           MaxLines="3"
                                           LineHeight="1.4"/>
                                    <!-- Date -->
                                    <Label Text="{Binding CreatedAt, StringFormat='{0:MMM d}'}"
                                           TextColor="{StaticResource HallowTextMuted}"
                                           FontSize="11"/>
                                </VerticalStackLayout>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
            
            <!-- Bottom Padding -->
            <BoxView HeightRequest="20"/>
            
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
